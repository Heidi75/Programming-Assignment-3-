rankhospital<-function( state, outcome, num = "best" ){
  
  ## Read the outcome data
  
  data <- read.csv("outcome-of-care-measures.csv", colClasses = "character")[,c(2,7,11,17,23)]
  
  
  ##Change names of columns to match outcome
  
  colnames(data) <- c("Hospital.Name", "State", "heart attack", "heart failure", "pneumonia")
  
  ## Check that state and outcome are valid
  
  if(!any(data$State == state)) {
    stop("invalid state")
  }
  
  if(! (outcome == "heart attack" || outcome == "heart failure" || outcome == "pneumonia") ) {
    stop("invalid outcome")
  }
  ##Check if num is valid, num can be best or worst or a number
  
  if (!(num=="best"|| num=="worst" ||is.numeric(num))){
    stop("invalid num")
  }
    ##For each state, find the hospital of the given rank
    
    # Remove row by state and columns state
    data = data[data$State==state,]
    data = data[,c(1,3,4,5)]
    
    # Remove columns by outcome, only left HospitalName and Deaths by outcome
    if(outcome == "heart attack") {
      data = data[,c(1,2)]
    } else if(outcome == "heart failure") {
      data = data[,c(1,3)]
    } else if(outcome == "pneumonia") {
      data = data[,c(1,4)]
    }
    
    #rename column 2 so you don't have to write each illness
    names(data)[2] = "Deaths"
    
    # Remove rows with NA
    data = data[!is.na(data$Deaths),]
    
    # Order by Deaths and then HospitalName
    data = data[order(data$Deaths, data$Hospital.Name),]
    
    # Return
    if (num %in% c("best","worst") || is.numeric(num) ) {
      if(num == "best") {
        return (data$Hospital.Name[1])
      }
      else if(num == "worst") {
        return (data$Hospital.Name[nrow(data)])
      }
    }
    else {
      return (data$Hospital.Name[num])
    }
    
}
    
rankhospital("NC", "heart attack", "worst")  
